# ุงูุชูุซูู ุงูุดุงูู ููุดุฑูุน Clinic2026_API ๐

ูุฐุง ุงูุชูุซูู ูุณุฑุฏ ุงููุตุฉ ุงููุงููุฉ ูุจูุงุก ุงููุธุงูุ ูู ุฃูู ุณุทุฑ ุฃูุงูุฑ ูุญุชู ุงูุญุงูุฉ ุงูููุงุฆูุฉ ุงููุชุทูุฑุฉุ ุฎุทูุฉ ุจุฎุทูุฉ.

---

## ุงููุฑุญูุฉ ุงูุฃููู: ุงูุชุฃุณูุณ (Foundation) ๐๏ธ

### 1. ุฅูุดุงุก ุงููุดุฑูุน (Inception)
ุจุฏุฃูุง ุจุฅูุดุงุก ูุดุฑูุน Web API ุญุฏูุซ ูุนุชูุฏ ุนูู ุชูููุฉ "Minimal API" ููููู ุฎูููุงู ูุณุฑูุนุงู.

**ุงูุฃูุงูุฑ ุงููููุฐุฉ:**
```bash
# ุฅูุดุงุก ุงูุญู (Solution)
dotnet new sln -n Clinic2026_API

# ุฅูุดุงุก ูุดุฑูุน ุงูู API
dotnet new webapi -n Clinic_API

# ุฅุถุงูุฉ ุงููุดุฑูุน ููุญู
dotnet sln add Clinic_API/Clinic2026_API.csproj
```

### 2. ุฅุนุฏุงุฏ ุงูุฃูุงู (Security & Trust)
ูุถูุงู ุนูู ุงูุจุฑูุชูููู ุงูุขูู HTTPS ูุญููุงู ุฏูู ุชุญุฐูุฑุงุช ุงููุชุตูุญ:

**ุงูุฃูุฑ ุงููููุฐ:**
```bash
dotnet dev-certs https --trust
```

### 3. ุฅุนุฏุงุฏุงุช ุงูุชุดุบูู (Configuration)
ูููุง ุจุชุนุฏูู ููู `Properties/launchSettings.json` ูุถูุงู:
*   ุฃู ูุนูู ุงููุธุงู ุงูุชุฑุงุถูุงู ุนูู `https`.
*   ุฃู ููุชุญ ุงููุชุตูุญ ุชููุงุฆูุงู ุนูู ุตูุญุฉ ุงูุชูุซูู `swagger`.

---

## ุงููุฑุญูุฉ ุงูุซุงููุฉ: ููุฏุณุฉ ูุงุนุฏุฉ ุงูุจูุงูุงุช (Database Architecture) ๐พ

### 1. ูููุฌูุฉ ุงูุนูู
ุงุนุชูุฏูุง ูููุฌูุฉ **Code-First** (ุงูููุฏ ุฃููุงู) ูู ุงูุจุฏุงูุฉ ูุชุตููู ุงูููุงุฐุฌ (Models)ุ ุซู ุชุญูููุง ููุชุฑููุฒ ุนูู ุงุณุชูุฑุงุฑ ูุงุนุฏุฉ ุงูุจูุงูุงุช.

### 2. ุชูุณูู ุงูููุงุฐุฌ (Models)
ุจุฏูุงู ูู ุงูููุถูุ ูููุง ุจุชูุณูู ุงูุฌุฏุงูู ุฅูู ูุฌูุฏุงุช ุญุณุจ ุงููุธููุฉ ุฏุงุฎู `Models`:
*   `System`: ููุฌุฏุงูู ุงูุฃุณุงุณูุฉ ูุซู ุงููุณุชุฎุฏููู (`TblUser`) ูุงูุฃุฏูุงุฑ.
*   `Finance`: ูููุธุงู ุงููุงูู (`FinChartOfAccount`, `FinCustomer`).
*   `Structure`: ูููููู ุงูุฅุฏุงุฑู ููููุธููู (`StrEmployee`).
*   `Lookup`: ูููุงุฆู ุงูุจุญุซ ุงูุซุงุจุชุฉ (`LtCountry`, `LtCity`).

### 3. ุณูุงู ุงูุจูุงูุงุช (DbContext)
ุฃูุดุฃูุง `Data/ClinicDbContext.cs` ููููู ุงูุฌุณุฑ ุจูู ุงูููุฏ ููุงุนุฏุฉ ุงูุจูุงูุงุช.
*   **ุนูุงูุงุช ุงูุฌุฏุงูู**: ูููุง ุจุถุจุท ุงูุนูุงูุงุช (ูุซู ุนูุงูุฉ ุงููุณุชุฎุฏู ุจุตูุงุญูุงุชู) ุฏุงุฎู ุฏุงูุฉ `OnModelCreating`.

---

## ุงููุฑุญูุฉ ุงูุซุงูุซุฉ: ููููุฉ ุงูููุฏ (Refactoring & Architecture) ๐๏ธ

ูู "Minimal API"ุ ููู `Program.cs` ูููู ููุชุถุฎู. ูููุง ุจุชูุธููู ูุชูุฒูุน ุงูููุงู ุจุงุณุชุฎุฏุงู **Extension Methods**.

### 1. ุงููุฌูุฏ `Extensions`
ุฃูุดุฃูุง ูุฐุง ุงููุฌูุฏ ููุญุชูู ุนูู ููุทู ุงููุธุงู ุงูููุตูู:

*   **`ServiceCollectionExtensions.cs`**:
    *   ูุญุชูู ุนูู `AddApplicationServices`.
    *   ูููู ุจุชุฌููุฒ ุงุชุตุงู ูุงุนุฏุฉ ุงูุจูุงูุงุช (SQL Server).
    *   ูููู ุจุฅุนุฏุงุฏ ุงูุชูุซูู (Swagger) ูุงูุฃูุงู (JWT).

*   **`WebApplicationExtensions.cs`**:
    *   ูุญุชูู ุนูู `ConfigureMiddleware`.
    *   ูุฑุชุจ "ุฏูุฑุฉ ุญูุงุฉ" ุงูุทูุจ (ุชูุนูู HTTPSุ ุชูุนูู Swaggerุ ุชูุนูู ุงููููุงุช ุงูุซุงุจุชุฉ).

*   **`EndpointExtensions.cs`**:
    *   ููุง ููููุง ูู ุงูุฑูุงุจุท (API Endpoints).
    *   ุงุณุชุฎุฏููุง ุชูููุฉ **Reflection** (`MapAllEntityEndpoints`) ูุฅูุดุงุก ูุงุฌูุงุช ูุฑุงุกุฉ (GET) ุชููุงุฆูุฉ ููู ุงูุฌุฏุงูู ุฏูุนุฉ ูุงุญุฏุฉ!
    *   ุฎุตุตูุง ุฏูุงู ูุฏููุฉ ููุนูููุงุช ุงููุนูุฏุฉ ูุซู `MapUserEndpoints` (ูุฅุถุงูุฉ ุงููุณุชุฎุฏููู ูุชุดููุฑ ูููุงุช ุงููุฑูุฑ).

---

## ุงููุฑุญูุฉ ุงูุฑุงุจุนุฉ: ุงูุฃูุงู ูุงููุตุงุฏูุฉ (Authentication & Security) ๐

ุจูููุง ูุธุงู ุฃูุงู ููู ููุชุนุฏุฏ ุงูุทุจูุงุช.

### 1. ุญูุงูุฉ ุงูุฑูุงุจุท
ุฃุถููุง `.RequireAuthorization()` ููู ุงูุฑูุงุจุทุ ููุง ูุนูู "ููููุน ุงูุฏุฎูู ุฅูุง ุจุชุตุฑูุญ".

### 2. ุฃููุงุน ุงูุชุตุงุฑูุญ (Tokens)
*   **JWT (JSON Web Token)**: ูููุณุชุฎุฏููู ุงููุณุฌููู ุนุจุฑ `/api/auth/login`.
*   **Static Token**: "ููุชุงุญ ุณุญุฑู" ูููุทูุฑูู (`barefoot2020`) ูุณูุญ ุจุฏุฎูู ุณุฑูุน.
*   **Dev Token**: ููุทุฉ ูุตูู ุฎุงุตุฉ ูููุทูุฑูู ูุงุณุชุจุฏุงู ุงูููุชุงุญ ุงูุณุญุฑู ุจู JWT ูุธุงูู.

### 3. ูุนุงูุฌุฉ ุงูุฃุฎุทุงุก (Global Error Handling)
ุฃูุดุฃูุง `Middleware/GlobalExceptionMiddleware.cs`.
*   **ูุธููุชู**: ุฅุฐุง ุญุฏุซ ุฃู ุฎุทุฃ (ูุซูุงู ูุงุนุฏุฉ ุงูุจูุงูุงุช ูุง ุชุณุชุฌูุจ)ุ ูุง ูููุงุฑ ุงููุธุงู ุฃูุงู ุงููุณุชุฎุฏู. ุจู ูููู ูุฐุง ุงูููุฏ ุจุงุตุทูุงุฏ ุงูุฎุทุฃ ูุฅุฑุฌุงุน ุฑุณุงูุฉ JSON ูุฑุชุจุฉ (ูุซูุงู "ุนุฐุฑุงูุ ุญุฏุซ ุฎุทุฃ ุฏุงุฎูู" ูุน ุฑูู ุงูุฎุทุฃ).

---

## ุงููุฑุญูุฉ ุงูุฎุงูุณุฉ: ุงููููุฉ ุงูุจุตุฑูุฉ (Branding & UI) ๐จ

ุญูููุง ูุงุฌูุฉ Swagger ุงูุงูุชุฑุงุถูุฉ ุงููููุฉ ุฅูู ูุงุฌูุฉ "Barefoot Clinic" ุงูุงุญุชุฑุงููุฉ.

### 1. ุงููููุงุช ุงูุซุงุจุชุฉ (`wwwroot`)
*   ุฃูุดุฃูุง ูุฌูุฏ `wwwroot/images` ููุถุนูุง ููู ุงูุดุนุงุฑ `logo.png`.
*   ุฃูุดุฃูุง ูุฌูุฏ `wwwroot/css` ููุถุนูุง ููู `swagger-custom.css`.

### 2. ุงูุชูุนูู ุงูุจุฑูุฌู
ูุชุธูุฑ ูุฐู ุงูุชุนุฏููุงุชุ ูููุง ุจูุง ููู ูู ุงูููุฏ:
1.  ุชูุนูู `app.UseStaticFiles()`: ููุณูุงุญ ูููุชุตูุญ ุจูุฑุงุกุฉ ุงูุตูุฑ ููููุงุช CSS.
2.  ุญูู ุงูุชุตููู (`InjectStylesheet`): ูู ุฅุนุฏุงุฏุงุช Swaggerุ ุฃูุฑูุง ุจุญูู ููู ุงูู CSS ุงูุฎุงุต ุจูุง.
3.  ุชุบููุฑ ุงูุนููุงู (`DocumentTitle`): ุฃุณูููุงู "Barefoot Swagger Documentation".

**ูุชูุฌุฉ CSS:**
*   ุฅุฎูุงุก ุดุฑูุท Swagger ุงูุฃุณูุฏ ุงูุนููู ุงูุงูุชุฑุงุถู.
*   ุฅุธูุงุฑ ุดุนุงุฑูุง ุจุญุฌู 50 ุจูุณู ุจุฌูุงุฑ ุงูุนููุงู.

---

## ุงููุฑุญูุฉ ุงูุณุงุฏุณุฉ: ุงูุชุญุณููุงุช ุงูุฃุฎูุฑุฉ (Optimization) โก

1.  **ุงูุชุฎุฒูู ุงููุคูุช (Caching)**:
    *   ูุนููุง `OutputCache` ูุชุณุฑูุน ุงุณุชุฑุฌุงุน ุงูุจูุงูุงุช ุงูุซุงุจุชุฉ (Jุฏุงูู Lookup).

2.  **ูุนุงูุฌุฉ ุงูุจูุงูุงุช (Serialization)**:
    *   ูุงุฌููุง ูุดููุฉ "ุงูุฏุงุฆุฑุฉ ุงูููุฑุบุฉ" (Circular Reference) ูู JSON.
    *   ุญูููุงูุง ุจุชูุนูู `ReferenceHandler.IgnoreCycles`.

3.  **ุฅุตูุงุญ ููุงุชูุญ ุงูุฌุฏุงูู (PK Refactor)**:
    *   ูุงู ุฌุฏูู ุงููุณุชุฎุฏููู ูุนุชูุฏ ุนูู `UserName` ูููุชุงุญ ุฃุณุงุณูุ ููุง ูููุน ุชุนุฏูู ุงูุงุณู.
    *   ูููุง ุจุชุนุฏููู ููุนุชูุฏ ุนูู `Id` (ุฑูู)ุ ููุง ุณูุญ ููุง ุจุชูุนูู ููุฒุฉ "ุชุนุฏูู ุงุณู ุงููุณุชุฎุฏู" ูู ุงููุธุงู.

---

## ุงูุฎูุงุตุฉ ูุงูุฏููู ุงูุชุดุบููู โ

ุงูุขูุ ุงููุธุงู ุฌุงูุฒ ูููุธู ูุงูุชุงูู:

*   **ูุชุดุบูู ุงููุธุงู**: `dotnet watch run`
*   **ูุฑุคูุฉ ุงูุชูุซูู**: ุงูุชุญ ุงููุชุตูุญ ุนูู ุงูุฑุงุจุท ุงูุธุงูุฑ (ุนุงุฏุฉ `https://localhost:7099/swagger`).
*   **ูุชุณุฌูู ุงูุฏุฎูู**: ุงุณุชุฎุฏู ุฒุฑ Authorize ูุงูููุชุงุญ `barefoot2020`.

ูุฐุง ุงููุธุงู ููุซู ุงูุขู ุจููุฉ ุชุญุชูุฉ ุจุฑูุฌูุฉ ูููุฉุ ูุงุจูุฉ ููุชูุณุนุ ูุขููุฉ.
